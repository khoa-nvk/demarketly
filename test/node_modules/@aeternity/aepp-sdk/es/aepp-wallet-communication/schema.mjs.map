{"version":3,"file":"schema.mjs","names":["BaseError","InternalError","MESSAGE_DIRECTION","WALLET_TYPE","SUBSCRIPTION_TYPES","METHODS","RPC_STATUS","rpcErrors","RpcError","toJSON","code","message","data","deserialize","json","RpcErr","find","cl","RpcInvalidTransactionError","constructor","name","push","RpcBroadcastError","RpcRejectedByUserError","RpcUnsupportedProtocolError","RpcConnectionDenyError","RpcNotAuthorizeError","RpcPermissionDenyError","address","RpcInternalError","RpcMethodNotFoundError"],"sources":["../../src/aepp-wallet-communication/schema.ts"],"sourcesContent":["// eslint-disable-next-line max-classes-per-file\nimport { Encoded } from '../utils/encoder';\nimport { BaseError, InternalError } from '../utils/errors';\n\n/**\n * @category aepp wallet communication\n */\nexport const enum MESSAGE_DIRECTION {\n  to_waellet = 'to_waellet',\n  to_aepp = 'to_aepp',\n}\n\n/**\n * @category aepp wallet communication\n */\nexport const enum WALLET_TYPE {\n  window = 'window',\n  extension = 'extension',\n}\n\n/**\n * @category aepp wallet communication\n */\nexport const enum SUBSCRIPTION_TYPES {\n  subscribe = 'subscribe',\n  unsubscribe = 'unsubscribe',\n}\n\n/**\n * @category aepp wallet communication\n */\nexport const enum METHODS {\n  readyToConnect = 'connection.announcePresence',\n  updateAddress = 'address.update',\n  address = 'address.get',\n  connect = 'connection.open',\n  sign = 'transaction.sign',\n  signMessage = 'message.sign',\n  subscribeAddress = 'address.subscribe',\n  updateNetwork = 'networkId.update',\n  closeConnection = 'connection.close',\n}\n\n/**\n * @category aepp wallet communication\n */\nexport const enum RPC_STATUS {\n  CONNECTED = 'CONNECTED',\n  DISCONNECTED = 'DISCONNECTED',\n  WAITING_FOR_CONNECTION_REQUEST = 'WAITING_FOR_CONNECTION_REQUEST',\n}\n\ninterface RpcErrorAsJson {\n  code: number;\n  message: string;\n  data?: any;\n}\n\nconst rpcErrors: Array<(new (data?: any) => RpcError) & { code: number }> = [];\n\n/**\n * @category exception\n */\nexport abstract class RpcError extends BaseError {\n  static code: number;\n\n  code: number;\n\n  data?: any;\n\n  toJSON(): RpcErrorAsJson {\n    return {\n      code: this.code,\n      message: this.message,\n      data: this.data,\n    };\n  }\n\n  static deserialize(json: RpcErrorAsJson): RpcError {\n    const RpcErr = rpcErrors.find((cl) => cl.code === json.code);\n    if (RpcErr == null) throw new InternalError(`Can't find RpcError with code: ${json.code}`);\n    return new RpcErr(json.data);\n  }\n}\n\n/**\n * @category exception\n */\nexport class RpcInvalidTransactionError extends RpcError {\n  static code = 2;\n\n  code = 2;\n\n  constructor(data?: any) {\n    super('Invalid transaction');\n    this.data = data;\n    this.name = 'RpcInvalidTransactionError';\n  }\n}\nrpcErrors.push(RpcInvalidTransactionError);\n\n/**\n * @category exception\n */\nexport class RpcBroadcastError extends RpcError {\n  static code = 3;\n\n  code = 3;\n\n  constructor(data?: any) {\n    super('Broadcast failed');\n    this.data = data;\n    this.name = 'RpcBroadcastError';\n  }\n}\nrpcErrors.push(RpcBroadcastError);\n\n/**\n * @category exception\n */\nexport class RpcRejectedByUserError extends RpcError {\n  static code = 4;\n\n  code = 4;\n\n  constructor(data?: any) {\n    super('Operation rejected by user');\n    this.data = data;\n    this.name = 'RpcRejectedByUserError';\n  }\n}\nrpcErrors.push(RpcRejectedByUserError);\n\n/**\n * @category exception\n */\nexport class RpcUnsupportedProtocolError extends RpcError {\n  static code = 5;\n\n  code = 5;\n\n  constructor() {\n    super('Unsupported Protocol Version');\n    this.name = 'RpcUnsupportedProtocolError';\n  }\n}\nrpcErrors.push(RpcUnsupportedProtocolError);\n\n/**\n * @category exception\n */\nexport class RpcConnectionDenyError extends RpcError {\n  static code = 9;\n\n  code = 9;\n\n  constructor(data?: any) {\n    super('Wallet deny your connection request');\n    this.data = data;\n    this.name = 'RpcConnectionDenyError';\n  }\n}\nrpcErrors.push(RpcConnectionDenyError);\n\n/**\n * @category exception\n */\nexport class RpcNotAuthorizeError extends RpcError {\n  static code = 10;\n\n  code = 10;\n\n  constructor() {\n    super('You are not connected to the wallet');\n    this.name = 'RpcNotAuthorizeError';\n  }\n}\nrpcErrors.push(RpcNotAuthorizeError);\n\n/**\n * @category exception\n */\nexport class RpcPermissionDenyError extends RpcError {\n  static code = 11;\n\n  code = 11;\n\n  constructor(address: Encoded.AccountAddress) {\n    super(`You are not subscribed for account ${address}`);\n    this.data = address;\n    this.name = 'RpcPermissionDenyError';\n  }\n}\nrpcErrors.push(RpcPermissionDenyError);\n\n/**\n * @category exception\n */\nexport class RpcInternalError extends RpcError {\n  static code = 12;\n\n  code = 12;\n\n  constructor() {\n    super('The peer failed to execute your request due to unknown error');\n    this.name = 'RpcInternalError';\n  }\n}\nrpcErrors.push(RpcInternalError);\n\n/**\n * @category exception\n */\nexport class RpcMethodNotFoundError extends RpcError {\n  static code = -32601;\n\n  code = -32601;\n\n  constructor() {\n    super('Method not found');\n    this.name = 'RpcMethodNotFoundError';\n  }\n}\nrpcErrors.push(RpcMethodNotFoundError);\n"],"mappings":"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"}